User:
  user_logged_in_or_in_params:
    type: OR
    dependences: [real_user_in_params, no_user_in_params_and_logged_in]
  real_user_in_params:
    type: AND
    dependences: [user_in_params, user_exist]
  no_user_in_params_and_logged_in:
    type: AND
    dependences: [!user_in_params, logged_in]
  user_in_params:
    type: FUNC
  user_exist:
    type: FUNC
  logged_in:
    type: FUNC
  allowed_to_auth:
    type: OR
    dependences: [!logged_in, is_post]
  is_post:
    type: FUNC
  not_logged_in_and_user_exist_by_email_and_role_and_not_confirmed:
    type: AND
    dependences: [!logged_in, user_exist_by_email_and_role, user_not_confirmed]
  user_exist_by_email_and_role:
    type: FUNC
  user_not_confirmed:
    type: FUNC

Confirmation:
  hash_exist:
    type: FUNC
